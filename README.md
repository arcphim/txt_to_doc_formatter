# 注意
exe正常运行，需要搭配config.json文件，config.json文件需要和exe文件在同一目录下

# Word自动排版工具

一个基于Python的Word文档自动排版工具，能够按照预设格式批量处理Word文档，满足特定的排版需求。

## 功能特点

- 支持批量导入和处理Word文档
- 支持批量导入和处理txt/md文档
- 可预览排版效果
- 提供图形界面调整排版参数
- 所有排版参数可保存和维护

## 排版参数

程序默认按照以下参数排版，可通过设置界面进行调整：

- **行距**：28磅（固定值）
- **页边距**：上、下3cm，左、右2.6cm
- **标题层级**：
  - 一级标题："一、"形式，3号方正黑体，首空2格
  - 二级标题："（一）"形式，3号方正楷体加粗，首空2格
  - 三级标题："1. "形式，不加粗，首空2格，末尾加句号
  - 四级标题："（1）"形式，不加粗，首空2格，末尾加句号
- **页码**：底部居中
- **段落间距**：段后0磅
- **对齐方式**：两端对齐
- **缩进**：首行缩进2个汉字宽度
- **字体**：
  - 标题：小2号方正小标宋字体
  - 正文：3号仿宋字体
  - 数字：3号Times New Roman字体
- 其他：取消孤行控制

## 安装说明

### 前提条件
- Python 3.7或更高版本
- pip（Python包管理工具）

### 安装步骤

1. 克隆或下载本项目到本地

2. 打开命令行终端，导航到项目目录

3. 安装依赖包：
```bash
pip install -r requirements.txt
```

## 使用方法

### 图形界面使用
1. 运行程序：
```bash
python main.py
```

2. 在"文档处理"标签页：
   - 点击"添加文件"或"添加文件夹"选择需要处理的Word文档
   - 选择输出目录
   - 点击"开始排版"进行批量处理
   - 或选择单个文件点击"预览效果"查看排版结果

### 命令行使用

#### Word文档排版
```bash
python main.py
```
然后使用图形界面进行操作。

#### txt/md文档转换
将txt或md文档转换为格式化的Word文档：
```bash
python txt_to_word.py <输入文件> <输出文件> [配置文件]
```

示例：
```bash
# 转换txt文件
python txt_to_word.py example.txt formatted_example.docx

# 转换md文件
python txt_to_word.py example.md formatted_example.docx
```

### 参数调整
在"排版设置"标签页可以调整以下参数：
- 页边距（上、下、左、右）
- 行距（固定值）
- 标题和正文字体及大小

修改后点击"保存设置"按钮应用更改。

## 注意事项
- 支持.docx、.doc、.txt和.md格式文件
- 确保系统中已安装所需字体（方正小标宋、方正黑体、方正楷体等）
- 处理大量文件时可能需要较长时间，请耐心等待
- txt/md转换功能会自动识别文档结构并应用相应的格式

## 故障排除

### 常见问题
1. **程序无法启动**：检查Python和依赖包是否正确安装
2. **排版效果不符合预期**：检查是否安装了所需字体，或尝试重置为默认设置
3. **中文显示乱码**：确保配置文件和源代码使用UTF-8编码
4. **文件处理失败**：检查文件是否被其他程序占用，或文件是否损坏

### 获取帮助
如遇到其他问题，请联系开发者或提交issue。

## 打包说明

项目提供了`build_app`脚本来将程序打包为Windows可执行文件（exe）。

### 使用方法
1. 确保已安装Python 3.7或更高版本
2. 双击`build_app`运行打包脚本
3. 脚本会自动检查Python、pip和PyInstaller的安装情况，并在必要时进行安装
4. 脚本会清理旧的构建文件，然后执行打包操作
5. 生成的可执行文件和相关资源位于`dist\doc_formatter`文件夹中

### 注意事项
- 打包过程可能需要几分钟时间
- 生成的应用程序位于`dist\doc_formatter`文件夹中
- 脚本会自动清理旧的`build`和`dist`文件夹
- 脚本使用Python的-m参数运行PyInstaller，避免了PATH环境变量配置问题
- 脚本包含详细的错误检查和处理机制，如果遇到问题会显示具体错误信息
## 更新日志

### v1.3.0
- 修改为两端对齐
- 段后间距设置为0磅
- 取消孤行控制

### v1.2.0
- 图形界面支持拖曳加载Word文档和txt/md文件
- 特殊符号处理为times new roman字体

### v1.1.0
- 功能优化

### v1.0.0
- 初始版本，实现基本排版功能
- 支持批量处理和预览
- 提供参数设置界面